{% extends 'base.html' %}
{% block title %}View Parking Lots{% endblock %}

{% block content %}
<div class="container my-4">
  <h2 class="mb-4">All Parking Lots</h2>

  <!-- Search Input Form -->
  <form method="GET" action="{{ url_for('view_parking_lots') }}" class="row mb-3">
    <div class="col-md-6">
      <input 
        type="text" 
        name="q" 
        value="{{ request.args.get('q', '') }}" 
        class="form-control" 
        placeholder="Search by location or PIN code"
        autocomplete="off"
      >
    </div>
    <div class="col-md-2">
      <button type="submit" class="btn btn-primary">Search</button>
    </div>
  </form>

  <!-- Table -->
  <div class="card shadow">
    <div class="card-body table-responsive">
      <table class="table table-striped table-bordered" id="parkingTable">
        <thead class="table-dark">
          <tr>
            <th>Location</th>
            <th>Address</th>
            <th>PIN Code</th>
            <th>Price/Hour</th>
            <th>Max Spots</th>
            <th>Filled</th>
            {% if session.get('is_admin') %}
            <th>Actions</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for lot in parking_lots %}
          <tr>
            <td>{{ lot.prime_location_name }}</td>
            <td>{{ lot.address }}</td>
            <td>{{ lot.pin_code }}</td>
            <td>â‚¹{{ lot.price_per_hour }}</td>
            <td>{{ lot.max_spots }}</td>
            <td>{{ lot.spots_filled }}</td>
            {% if session.get('is_admin') %}
<td>
  <a href="{{ url_for('edit_parking', lot_id=lot.id) }}" class="btn btn-sm btn-warning">Edit</a>
  <a href="{{ url_for('delete_parking', lot_id=lot.id) }}" class="btn btn-sm btn-danger"
     onclick="return confirm('Are you sure you want to delete this parking lot?');">Delete</a>
</td>
{% endif %}

          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}

